<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>
  <div id="tabs">
    <button class="tab-button active-tab" data-tab="main" onclick="showTab('main')">Main</button>
  <button class="tab-button" data-tab="comaruFamily" onclick="showTab('comaruFamily')">Comaru Family</button>
  <button class="tab-button" data-tab="pig" onclick="showTab('pig')">Pig</button>
  <button class="tab-button" data-tab="arctic_vixen" onclick="showTab('arctic_vixen')">Arctic Vixen</button>
  <button class="tab-button" data-tab="others" onclick="showTab('others')">Others</button>
  </div>
  <h2>File Upload</h2>
  <form action="/upload" method="post" enctype="multipart/form-data">
    <input type="file" name="file">
    <input type="submit" value="Upload File">
  </form>

  <h2>View and Download GIF</h2>
  <input type="text" id="gifIdInput" placeholder="GIF ID"> <!-- Текстове поле для введення ідентифікатора GIF -->
  <button onclick="openGif()">Open GIF</button>
  <button onclick="downloadGif()">Download GIF</button>
  <video id="" controls class="styled-video" style="display: none;"></video> <!-- <video> для відображення GIF з класом "styled-video" -->
  <img id="gifImage" style="display: none;"> <!-- <img> для відображення GIF -->
  <div id="gifAttributes"></div>
  <!--<div id="contentType"></div>
  <div id="gifIdElement"></div>-->



  <!--<h2>Download GIF as Text</h2>
  <input type="text" id="EasyViewGif" style="display: none;">-->
  <!--<button onclick="downloadTextGif()" style="display: none;">Download GIF as Text</button>
  <a id="downloadTextLink" style="display: none;">Download GIF as Text</a>-->

 <!--<h2>Download GIF</h2>
<input type="text" id="downloadGifId" placeholder="Enter GIF ID">
<button onclick="downloadGif()">Download GIF</button>-->

<!-- Блок для відображення списку Comaru GIFs -->
<div class="gif-container" id="comaruGifContainer" style="display: none;">
  <div class="gif-columns">
    <ul id="comaruGifList"></ul>
  </div>
</div>

<!-- Блок для відображення списку Pig GIFs -->
<div class="gif-container" id="pigGifContainer" style="display: none;">
  <div class="gif-columns">
    <ul id="pigGifList"></ul>
  </div>
</div>

<!-- Блок для відображення списку Others GIFs -->
<div class="gif-container" id="othersGifContainer" style="display: none;">
  <div class="gif-columns">
    <ul id="othersGifList"></ul>
  </div>
</div>

<!-- Блок для відображення списку Arctic_Vixen GIFs -->
<div class="gif-container" id="arctic_vixenGifContainer" style="display: none;">
  <div class="gif-columns">
    <ul id="arctic_vixenGifList"></ul>
  </div>
</div>

<!-- Блок для відображення списку гіфок -->
<div class="gif-container" id="allGifContainer" style="display: none;">
  <h2>List of GIFs</h2>
  <div class="gif-columns">
    <ul id="gifList"></ul>
  </div>
</div>

  <script>
    function openGif() {
      console.log('Button clicked'); // Перевірка чи кнопка натиснута
      const gifIdInput = document.getElementById('gifIdInput');
      const gifId = gifIdInput.value; // Отримання ідентифікатор GIF з текстового поля
      const gifImage = document.getElementById('gifImage');
      fetch(`/get-gif/${gifId}`)
        .then(response => {
          if (response.status === 404) {
            console.error('GIF not found');
          } else if (!response.ok) {
            console.error('Error fetching GIF:', response.status);
          } else {
            return response.blob();
          }
        })
        .then(blob => {
          if (blob) {
            const gifUrl = URL.createObjectURL(blob);
            gifImage.src = gifUrl;
            gifImage.style.display = 'block';
        console.log(blob);
          }
        })
        .catch(error => {
          console.error('Error fetching GIF:', error);
        });
      
      fetch(`/get-gif-attributes/${gifId}`) // Отримання атрибутів
          .then(response => response.json())
          .then(attributes => {
            document.getElementById('gifAttributes').textContent = `Attributes: ${attributes.join(', ')}`;
          })
          .catch(error => {
            console.error('Error fetching attributes:', error);
          });
    }

    /*function downloadTextGif() {
  const gifIdInput = document.getElementById('downloadTextGifId');
  const gifId = gifIdInput.value;

  fetch(`/get-gif-text/${gifId}`)
    .then(response => {
      if (response.status === 404) {
        console.error('GIF not found');
      } else if (!response.ok) {
        console.error('Error fetching GIF:', response.status);
      } else {
        return response.text();
      }
    })
    .then(data => {
      if (data) {
        const blob = new Blob([data], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `${gifId}.txt`;
        a.style.display = 'none';
        document.body.appendChild(a);
        a.click();
        window.URL.revokeObjectURL(url);
      }
    })
    .catch(error => {
      console.error('Error fetching GIF:', error);
    });
}*/

function downloadGif() {
  const gifIdInput = document.getElementById('gifIdInput');
  const gifId = gifIdInput.value;

  fetch(`/download-gif/${gifId}`)
    .then(response => {
      if (response.status === 404) {
        console.error('GIF not found');
      } else if (!response.ok) {
        console.error('Error fetching GIF:', response.status);
      } else {
        return response.blob();
      }
    })
    .then(blob => {
      if (blob) {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'downloaded.gif'; // Ім'я файлу для завантаження
        a.style.display = 'none';
        document.body.appendChild(a);
        a.click();
        window.URL.revokeObjectURL(url);
      }
    })
    .catch(error => {
      console.error('Error fetching GIF:', error);
    });
}

function displayGifList() {
      const allGifContainer = document.getElementById('allGifContainer');
      allGifContainer.style.display = 'block'; 

      const gifList = document.getElementById('gifList');
      gifList.innerHTML = ''; // Очистити список

      // Запит до сервера для отримання списку гіфок
      fetch('/get-gif-list')
        .then(response => response.json())
        .then(data => {
          if (data.length > 0) {
            data.forEach(gif => {
              const listItem = document.createElement('li');
              listItem.innerHTML = `<a href="#" onclick="showGif('${gif._id}')">${gif.filename}</a>`;
              gifList.appendChild(listItem);
            });
          } else {
            gifList.innerHTML = '<li>No GIFs available.</li>';
          }
        })
        .catch(error => {
          console.error('Error fetching GIF list:', error);
        });
    }

    function showGif(gifId) {
      const gifIdInput = document.getElementById('gifIdInput');
      gifIdInput.value = gifId;
      openGif();
    }

    displayGifList(); // Виклик функції при завантаженні сторінки для відображення списку гіфок
    function displayComaruGifList() {
      const comaruGifContainer = document.getElementById('comaruGifContainer');
      comaruGifContainer.style.display = 'block'; // Показати контейнер для Comaru GIFs

      const gifList = document.getElementById('gifList');
      gifList.innerHTML = ''; // Очистити список

      // Запит до сервера для отримання списку "Comaru" гіфок
      fetch('/get-Comaru-gif-list')
        .then(response => response.json())
        .then(data => {
          if (data.length > 0) {
            data.forEach(gif => {
              const listItem = document.createElement('li');
              listItem.innerHTML = `<a href="#" onclick="showGif('${gif._id}')">${gif.filename}</a>`;
              gifList.appendChild(listItem);
            });
          } else {
            gifList.innerHTML = '<li>No "Comaru" GIFs available.</li>';
          }
        })
        .catch(error => {
          console.error('Error fetching "Comaru" GIF list:', error);
        });
    }
  function displayPigGifList() {
      const pigGifContainer = document.getElementById('pigGifContainer');
      pigGifContainer.style.display = 'block'; // Показати контейнер для pig GIFs

      const gifList = document.getElementById('gifList');
      gifList.innerHTML = ''; // Очистити список

      // Запит до сервера для отримання списку "pig" гіфок
      fetch('/get-Pig-gif-list')
        .then(response => response.json())
        .then(data => {
          if (data.length > 0) {
            data.forEach(gif => {
              const listItem = document.createElement('li');
              listItem.innerHTML = `<a href="#" onclick="showGif('${gif._id}')">${gif.filename}</a>`;
              gifList.appendChild(listItem);
            });
          } else {
            gifList.innerHTML = '<li>No "others" GIFs available.</li>';
          }
        })
        .catch(error => {
          console.error('Error fetching "others" GIF list:', error);
        });
    }
  function displayArctic_VixenGifList() {
      const arctic_vixenGifContainer = document.getElementById('arctic_vixenGifContainer');
      arctic_vixenGifContainer.style.display = 'block'; // Показати контейнер для pig GIFs

      const gifList = document.getElementById('gifList');
      gifList.innerHTML = ''; // Очистити список

      // Запит до сервера для отримання списку "arctic_vixen" гіфок
      fetch('/get-Arctic_Vixen-gif-list')
        .then(response => response.json())
        .then(data => {
          if (data.length > 0) {
            data.forEach(gif => {
              const listItem = document.createElement('li');
              listItem.innerHTML = `<a href="#" onclick="showGif('${gif._id}')">${gif.filename}</a>`;
              gifList.appendChild(listItem);
            });
          } else {
            gifList.innerHTML = '<li>No "arctic_vixen" GIFs available.</li>';
          }
        })
        .catch(error => {
          console.error('Error fetching "arctic_vixen" GIF list:', error);
        });
    }

  function displayOthersGifList() {
      const othersGifContainer = document.getElementById('othersGifContainer');
      othersGifContainer.style.display = 'block'; // Показати контейнер для pig GIFs

      const gifList = document.getElementById('gifList');
      gifList.innerHTML = ''; // Очистити список

      // Запит до сервера для отримання списку "others" гіфок
      fetch('/get-Others-gif-list')
        .then(response => response.json())
        .then(data => {
          if (data.length > 0) {
            data.forEach(gif => {
              const listItem = document.createElement('li');
              listItem.innerHTML = `<a href="#" onclick="showGif('${gif._id}')">${gif.filename}</a>`;
              gifList.appendChild(listItem);
            });
          } else {
            gifList.innerHTML = '<li>No "pig" GIFs available.</li>';
          }
        })
        .catch(error => {
          console.error('Error fetching "pig" GIF list:', error);
        });
  }
  let activeTab = 'main'; // Збереження активної вкладки

  function showTab(tabName) {
    // Зняття класу "active-tab" з поточної активної вкладки
    const currentActiveButton = document.querySelector(`.tab-button[data-tab="${activeTab}"]`);
    currentActiveButton.classList.remove('active-tab');

    // Встановлення класу "active-tab" для нової активної вкладки
    const newActiveButton = document.querySelector(`.tab-button[data-tab="${tabName}"]`);
    newActiveButton.classList.add('active-tab');

    // Оновлення активної вкладки
    activeTab = tabName;
    // Перемикання вкладок
    if (tabName === 'main'){
      displayGifList();
    }
    else if (tabName === 'comaruFamily') {
      displayComaruGifList();
    }
    else if (tabName === 'pig') {
      displayPigGifList();
    }
    else if (tabName === 'others') {
      displayOthersGifList();
    }
    else if (tabName === 'arctic_vixen') {
      displayArctic_VixenGifList();
    }
  }
  
  </script>
  
</body>
</html>